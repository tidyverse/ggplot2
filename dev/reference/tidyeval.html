<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Tidy eval helpers — tidyeval • ggplot2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tidy eval helpers — tidyeval"><meta name="description" content="This page lists the tidy eval tools reexported in this package from
rlang. To learn about using tidy eval in scripts and packages at a
high level, see the dplyr programming vignette
and the ggplot2 in packages vignette.
The Metaprogramming section of Advanced R may also be useful for a deeper dive.
The tidy eval operators {{, !!, and !!! are syntactic
constructs which are specially interpreted by tidy eval functions.
You will mostly need {{, as !! and !!! are more advanced
operators which you should not have to use in simple cases.
The curly-curly operator {{ allows you to tunnel data-variables
passed from function arguments inside other tidy eval functions.
{{ is designed for individual arguments. To pass multiple
arguments contained in dots, use ... in the normal way.
my_function &amp;lt;- function(data, var, ...) {
  data %&amp;gt;%
    group_by(...) %&amp;gt;%
    summarise(mean = mean({{ var }}))
}

enquo() and enquos() delay the execution of one or several
function arguments. The former returns a single expression, the
latter returns a list of expressions. Once defused, expressions
will no longer evaluate on their own. They must be injected back
into an evaluation context with !! (for a single expression) and
!!! (for a list of expressions).
my_function &amp;lt;- function(data, var, ...) {
  # Defuse
  var &amp;lt;- enquo(var)
  dots &amp;lt;- enquos(...)

  # Inject
  data %&amp;gt;%
    group_by(!!!dots) %&amp;gt;%
    summarise(mean = mean(!!var))
}

In this simple case, the code is equivalent to the usage of {{
and ... above. Defusing with enquo() or enquos() is only
needed in more complex cases, for instance if you need to inspect
or modify the expressions in some way.
The .data pronoun is an object that represents the current
slice of data. If you have a variable name in a string, use the
.data pronoun to subset that variable with [[.
my_var &amp;lt;- &quot;disp&quot;
mtcars %&amp;gt;% summarise(mean = mean(.data[[my_var]]))

Another tidy eval operator is :=. It makes it possible to use
glue and curly-curly syntax on the LHS of =. For technical
reasons, the R language doesn't support complex expressions on
the left of =, so we use := as a workaround.
my_function &amp;lt;- function(data, var, suffix = &quot;foo&quot;) {
  # Use `{{` to tunnel function arguments and the usual glue
  # operator `{` to interpolate plain strings.
  data %&amp;gt;%
    summarise(&quot;{{ var }}_mean_{suffix}&quot; := mean({{ var }}))
}

Many tidy eval functions like dplyr::mutate() or
dplyr::summarise() give an automatic name to unnamed inputs. If
you need to create the same sort of automatic names by yourself,
use as_label(). For instance, the glue-tunnelling syntax above
can be reproduced manually with:
my_function &amp;lt;- function(data, var, suffix = &quot;foo&quot;) {
  var &amp;lt;- enquo(var)
  prefix &amp;lt;- as_label(var)
  data %&amp;gt;%
    summarise(&quot;{prefix}_mean_{suffix}&quot; := mean(!!var))
}

Expressions defused with enquo() (or tunnelled with {{) need
not be simple column names, they can be arbitrarily complex.
as_label() handles those cases gracefully. If your code assumes
a simple column name, use as_name() instead. This is safer
because it throws an error if the input is not a name as expected.

"><meta property="og:description" content="This page lists the tidy eval tools reexported in this package from
rlang. To learn about using tidy eval in scripts and packages at a
high level, see the dplyr programming vignette
and the ggplot2 in packages vignette.
The Metaprogramming section of Advanced R may also be useful for a deeper dive.
The tidy eval operators {{, !!, and !!! are syntactic
constructs which are specially interpreted by tidy eval functions.
You will mostly need {{, as !! and !!! are more advanced
operators which you should not have to use in simple cases.
The curly-curly operator {{ allows you to tunnel data-variables
passed from function arguments inside other tidy eval functions.
{{ is designed for individual arguments. To pass multiple
arguments contained in dots, use ... in the normal way.
my_function &amp;lt;- function(data, var, ...) {
  data %&amp;gt;%
    group_by(...) %&amp;gt;%
    summarise(mean = mean({{ var }}))
}

enquo() and enquos() delay the execution of one or several
function arguments. The former returns a single expression, the
latter returns a list of expressions. Once defused, expressions
will no longer evaluate on their own. They must be injected back
into an evaluation context with !! (for a single expression) and
!!! (for a list of expressions).
my_function &amp;lt;- function(data, var, ...) {
  # Defuse
  var &amp;lt;- enquo(var)
  dots &amp;lt;- enquos(...)

  # Inject
  data %&amp;gt;%
    group_by(!!!dots) %&amp;gt;%
    summarise(mean = mean(!!var))
}

In this simple case, the code is equivalent to the usage of {{
and ... above. Defusing with enquo() or enquos() is only
needed in more complex cases, for instance if you need to inspect
or modify the expressions in some way.
The .data pronoun is an object that represents the current
slice of data. If you have a variable name in a string, use the
.data pronoun to subset that variable with [[.
my_var &amp;lt;- &quot;disp&quot;
mtcars %&amp;gt;% summarise(mean = mean(.data[[my_var]]))

Another tidy eval operator is :=. It makes it possible to use
glue and curly-curly syntax on the LHS of =. For technical
reasons, the R language doesn't support complex expressions on
the left of =, so we use := as a workaround.
my_function &amp;lt;- function(data, var, suffix = &quot;foo&quot;) {
  # Use `{{` to tunnel function arguments and the usual glue
  # operator `{` to interpolate plain strings.
  data %&amp;gt;%
    summarise(&quot;{{ var }}_mean_{suffix}&quot; := mean({{ var }}))
}

Many tidy eval functions like dplyr::mutate() or
dplyr::summarise() give an automatic name to unnamed inputs. If
you need to create the same sort of automatic names by yourself,
use as_label(). For instance, the glue-tunnelling syntax above
can be reproduced manually with:
my_function &amp;lt;- function(data, var, suffix = &quot;foo&quot;) {
  var &amp;lt;- enquo(var)
  prefix &amp;lt;- as_label(var)
  data %&amp;gt;%
    summarise(&quot;{prefix}_mean_{suffix}&quot; := mean(!!var))
}

Expressions defused with enquo() (or tunnelled with {{) need
not be simple column names, they can be arbitrarily complex.
as_label() handles those cases gracefully. If your code assumes
a simple column name, use as_name() instead. This is safer
because it throws an error if the input is not a name as expected.

"><meta property="og:image" content="https://ggplot2.tidyverse.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="ggplot2.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggplot2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.5.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ggplot2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2024/02/ggplot2-3-5-0/">Version 3.5.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2022/11/ggplot2-3-4-0/">Version 3.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/03/ggplot2-3-3-0/">Version 3.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/06/ggplot2-3-2-0/">Version 3.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/10/ggplot2-3-1-0/">Version 3.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/07/ggplot2-3-0-0/">Version 3.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/ggplot2-2-2-0/">Version 2.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/ggplot2-2-1-0/">Version 2.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/ggplot2-2-0-0/">Version 2.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/ggplot2-updates/">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ggplot2-specs.html">Aesthetic specifications</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer</h6></li>
    <li><a class="dropdown-item" href="../articles/extending-ggplot2.html">Extending ggplot2</a></li>
    <li><a class="dropdown-item" href="../articles/ggplot2-in-packages.html">Using ggplot2 in packages</a></li>
    <li><a class="dropdown-item" href="../articles/profiling.html">Profiling Performance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FAQ</h6></li>
    <li><a class="dropdown-item" href="../articles/faq-axes.html">FAQ: Axes</a></li>
    <li><a class="dropdown-item" href="../articles/faq-faceting.html">FAQ: Faceting</a></li>
    <li><a class="dropdown-item" href="../articles/faq-customising.html">FAQ: Customising</a></li>
    <li><a class="dropdown-item" href="../articles/faq-annotation.html">FAQ: Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/faq-reordering.html">FAQ: Reordering</a></li>
    <li><a class="dropdown-item" href="../articles/faq-bars.html">FAQ: Barplots</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://exts.ggplot2.tidyverse.org/gallery/">Extensions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/ggplot2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidy eval helpers</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/ggplot2/blob/main/R/utilities-tidy-eval.R" class="external-link"><code>R/utilities-tidy-eval.R</code></a></small>
      <div class="d-none name"><code>tidyeval.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This page lists the tidy eval tools reexported in this package from
rlang. To learn about using tidy eval in scripts and packages at a
high level, see the <a href="https://dplyr.tidyverse.org/articles/programming.html" class="external-link">dplyr programming vignette</a>
and the <a href="https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html">ggplot2 in packages vignette</a>.
The <a href="https://adv-r.hadley.nz/metaprogramming.html" class="external-link">Metaprogramming section</a> of <a href="https://adv-r.hadley.nz" class="external-link">Advanced R</a> may also be useful for a deeper dive.</p><ul><li><p>The tidy eval operators <code>{{</code>, <code>!!</code>, and <code>!!!</code> are syntactic
constructs which are specially interpreted by tidy eval functions.
You will mostly need <code>{{</code>, as <code>!!</code> and <code>!!!</code> are more advanced
operators which you should not have to use in simple cases.</p>
<p>The curly-curly operator <code>{{</code> allows you to tunnel data-variables
passed from function arguments inside other tidy eval functions.
<code>{{</code> is designed for individual arguments. To pass multiple
arguments contained in dots, use <code>...</code> in the normal way.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, ...) {</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="fu">group_by</span>(...) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>({{ var }}))</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>}</span></code></pre><p></p></div></li>
<li><p><code>enquo()</code> and <code>enquos()</code> delay the execution of one or several
function arguments. The former returns a single expression, the
latter returns a list of expressions. Once defused, expressions
will no longer evaluate on their own. They must be injected back
into an evaluation context with <code>!!</code> (for a single expression) and
<code>!!!</code> (for a list of expressions).</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, ...) {</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="co"># Defuse</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  var <span class="ot">&lt;-</span> <span class="fu">enquo</span>(var)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  dots <span class="ot">&lt;-</span> <span class="fu">enquos</span>(...)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="co"># Inject</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!!</span>dots) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(<span class="sc">!!</span>var))</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>}</span></code></pre><p></p></div>
<p>In this simple case, the code is equivalent to the usage of <code>{{</code>
and <code>...</code> above. Defusing with <code>enquo()</code> or <code>enquos()</code> is only
needed in more complex cases, for instance if you need to inspect
or modify the expressions in some way.</p></li>
<li><p>The <code>.data</code> pronoun is an object that represents the current
slice of data. If you have a variable name in a string, use the
<code>.data</code> pronoun to subset that variable with <code>[[</code>.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>my_var <span class="ot">&lt;-</span> <span class="st">"disp"</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(.data[[my_var]]))</span></code></pre><p></p></div></li>
<li><p>Another tidy eval operator is <code>:=</code>. It makes it possible to use
glue and curly-curly syntax on the LHS of <code>=</code>. For technical
reasons, the R language doesn't support complex expressions on
the left of <code>=</code>, so we use <code>:=</code> as a workaround.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, <span class="at">suffix =</span> <span class="st">"foo"</span>) {</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="co"># Use `{{` to tunnel function arguments and the usual glue</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="co"># operator `{` to interpolate plain strings.</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="st">"{{ var }}_mean_{suffix}"</span> <span class="sc">:=</span> <span class="fu">mean</span>({{ var }}))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>}</span></code></pre><p></p></div></li>
<li><p>Many tidy eval functions like <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> or
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise()</a></code> give an automatic name to unnamed inputs. If
you need to create the same sort of automatic names by yourself,
use <code>as_label()</code>. For instance, the glue-tunnelling syntax above
can be reproduced manually with:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, <span class="at">suffix =</span> <span class="st">"foo"</span>) {</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  var <span class="ot">&lt;-</span> <span class="fu">enquo</span>(var)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  prefix <span class="ot">&lt;-</span> <span class="fu">as_label</span>(var)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="st">"{prefix}_mean_{suffix}"</span> <span class="sc">:=</span> <span class="fu">mean</span>(<span class="sc">!!</span>var))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>}</span></code></pre><p></p></div>
<p>Expressions defused with <code>enquo()</code> (or tunnelled with <code>{{</code>) need
not be simple column names, they can be arbitrarily complex.
<code>as_label()</code> handles those cases gracefully. If your code assumes
a simple column name, use <code>as_name()</code> instead. This is safer
because it throws an error if the input is not a name as expected.</p></li>
</ul></div>



  </main></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://github.com/wch" class="external-link">Winston Chang</a>, <a href="https://github.com/lionel-" class="external-link">Lionel Henry</a>, <a href="https://data-imaginist.com" class="external-link">Thomas Lin Pedersen</a>, Kohske Takahashi, <a href="https://clauswilke.com" class="external-link">Claus Wilke</a>, <a href="https://karawoo.com" class="external-link">Kara Woo</a>, <a href="https://yutani.rbind.io" class="external-link">Hiroaki Yutani</a>, <a href="https://fishandwhistle.net" class="external-link">Dewey Dunnington</a>, Teun van den Brand, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

